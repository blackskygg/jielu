import http.client, urllib.request, urllib.parse, urllib.error
import os
import json
import time
import errno
import copy
import socket

#
#
# params = urllib.parse.urlencode({
#     # Request parameters
#     'visualFeatures': 'All',
# })

filename = "screen.jpg"
# headersz = {
#     # Request headers
#     'Content-Type': 'application/octet-stream',
#     'Ocp-Apim-Subscription-Key': '5149efd4a1ad42c68e93b89e5294e87d',
# }
#
# paramsz = urllib.parse.urlencode({
#     # Request parameters
#     'visualFeatures': 'All',
# })

class PornDetector:
    def __init__(self):
        self._conn = http.client.HTTPSConnection('api.projectoxford.ai', timeout = 5)
        self._img_bin = None
        self._is_developer_mode = False
        self.headers = {"Ocp-Apim-Subscription-Key" : '5149efd4a1ad42c68e93b89e5294e87d'}
        # self.enable_porn =True
        # self.enable_racy =False
        # self._cacheID = None
    def porn_detector(self, enable_porn = True, enable_racy = False, is_developer_mode = True):
        self._is_developer_mode = is_developer_mode
        status = 0
        # self.enable_racy = enable_racy
        # self.enable_porn = enable_porn
        if enable_porn or enable_racy:
            status = self.porn_image(enable_porn, enable_racy)

        if status == 0:
            return 'OK'
        elif status == 1:
            return "PORN_DETECTED"
        else:
            return "NO_INTERNET"

    def update_photo(self):
        os.system("scrot " + filename)
        self._img_bin = open(filename, 'rb').read()
        # headers = self.headers_gen({"Content-Type" : "image/jpeg"} )
        # params = self.params_gen()
        # self._conn.request("POST", "/Image/Cache/&%s" % params, img_bin, headers)
        # data = self._conn.getresponse().read()
        # print(data)
        # self._cacheID = data["CacheId"]
    def remove_photo(self):
        pass
        # headers = self.headers_gen()
        # params = self.params_gen(CacheID=self._cacheID)
        # self._conn.request("DELETE", "/Image/Cache/&%s" % params, img_bin, headers)

    def headers_gen(self, dic = {}):
        headers = self.headers.copy()
        headers.update(dic)
        return headers

    def params_gen(self, **kwargs):
        params = dict(**kwargs)
        params = urllib.parse.urlencode(params)
        return params

    # def porn_text(self):
    #     self.update_photo()
    #     params = self.params_gen(language="unk", detectOrientation=False)
    #     headers = self.headers_gen({"Content-Type": "application/octet-stream"})
    #     print(len(self._img_bin))
    #     try:
    #         self._conn.request("POST", "/vision/v1/ocr?%s" % params, self._img_bin, headers)
    #         response = self._conn.getresponse()
    #
    #     except (socket.timeout, socket.gaierror, http.client.CannotSendRequest) as e:
    #         print(e)
    #         self.__del__()
    #         self.__init__()
    #         return -1
    #     data = response.read()
    #     if response.code == 200:
    #         data = json.loads(data.decode())
    #         for region in data["regions"]:
    #             for line in region["lines"]:
    #                 for word in line["words"]:
    #                     print(word["text"], end= '')
    #             print('')
    #         else:
    #             return 0
    #
    #         # if data["adult"]["isAdultContent"]:
    #         #     return 1
    #         # elif self._is_developer_mode and "Yellow" in data["color"]["dominantColors"]:
    #         #     return 1
    #         # else:
    #         #     return 0
    #     elif response.code == 500:
    #         return -1
    #     else:
    #         print(response.code)
    #         print(response.read())
    #         return 0
    #
    #     pass

    def porn_image(self, enable_porn = True, enable_racy = False):

        self.update_photo()
        params = self.params_gen(visualFeatures = "Adult,Color")
        headers = self.headers_gen({"Content-Type": "application/octet-stream"})
        print(len(self._img_bin))
        try:
            self._conn.request("POST", "/vision/v1/analyses?%s" % params, self._img_bin, headers)
            response = self._conn.getresponse()

        except (socket.timeout, socket.gaierror, http.client.CannotSendRequest, ConnectionResetError) as e:
            print(e)
            self.__del__()
            self.__init__()
            return -1
        data = response.read()
        if response.code == 200:
            data = json.loads(data.decode())
            print(data)
            if enable_porn and data["adult"]["isAdultContent"]:
                return 1
            elif enable_racy and data["adult"]["isRacyContent"]:
                return 1
            elif self._is_developer_mode and "Yellow" in data["color"]["dominantColors"]:
                return 1
            else:
                return 0
        elif response.code == 500:
            return -1
        else:
            print(response.code)
            print(response.read())
            return 0

    def __del__(self):
        self._conn.close()


def exe():
    init_time = time.time()
    pder = PornDetector()
    print(time.time() - init_time)
    print("ARE YOU OK?")
    while True:
        print(pder.porn_detector(False, True))
        print(time.time() - init_time)
        time.sleep(1)
        init_time += 1

if __name__ == "__main__":
    exe()
    '''
    {'textAngle': 0.0,
    'regions':
        [{'lines':
            [{'boundingBox': '39,48,181,12',
                'words': [{'boundingBox': '39,48,24,12', 'text': 'Edit'}, {'boundingBox': '76,48,29,10', 'text': 'View'}, {'boundingBox': '119,48,55,12', 'text': 'Navigate'}, {'boundingBox': '189,48,31,10', 'text': 'Code'}]}, {'boundingBox': '69,72,133,14', 'words': [{'boundingBox': '69,72,5,12', 'text': '、'}, {'boundingBox': '98,77,6,9', 'text': '卩'}, {'boundingBox': '106,76,19,8', 'text': 'orn'}, {'boundingBox': '126,85,8,1', 'text': '一'}, {'boundingBox': '135,77,6,7', 'text': '0'}, {'boundingBox': '154,77,6,7', 'text': '0'}, {'boundingBox': '179,77,6,9', 'text': '口'}, {'boundingBox': '187,77,5,9', 'text': 'y'}, {'boundingBox': '197,72,5,14', 'text': '）'}]}, {'boundingBox': '29,101,30,10', 'words': [{'boundingBox': '29,101,12,9', 'text': 'Pr'}, {'boundingBox': '52,102,7,9', 'text': '，'}]}, {'boundingBox': '39,120,159,12', 'words': [{'boundingBox': '39,120,159,12', 'text': '(—/pythonprojects/azure)'}]}, {'boundingBox': '19,143,43,9', 'words': [{'boundingBox': '19,143,1,7', 'text': '丨'}, {'boundingBox': '22,143,9,7', 'text': 'm'}, {'boundingBox': '33,143,6,7', 'text': 'a'}, {'boundingBox': '41,143,6,9', 'text': 'g'}, {'boundingBox': '49,143,6,7', 'text': 'e'}, {'boundingBox': '57,143,5,7', 'text': 'S'}]}, {'boundingBox': '541,898,106,13', 'words': [{'boundingBox': '541,898,2,6', 'text': '，'}, {'boundingBox': '547,899,15,9', 'text': '39'}, {'boundingBox': '565,906,3,5', 'text': '，'}, {'boundingBox': '570,899,16,9', 'text': '48'}, {'boundingBox': '589,906,3,5', 'text': '，'}, {'boundingBox': '595,899,23,9', 'text': '181'}, {'boundingBox': '621,906,3,5', 'text': '，'}, {'boundingBox': '627,899,15,9', 'text': '12'}, {'boundingBox': '645,898,2,5', 'text': '，'}]}, {'boundingBox': '877,898,98,13', 'words': [{'boundingBox': '877,898,2,6', 'text': '，'}, {'boundingBox': '883,899,15,9', 'text': '39'}, {'boundingBox': '901,906,3,5', 'text': '，'}, {'boundingBox': '906,899,16,9', 'text': '48'}, {'boundingBox': '925,906,3,5', 'text': '，'}, {'boundingBox': '931,899,15,9', 'text': '24'}, {'boundingBox': '949,906,3,5', 'text': '，'}, {'boundingBox': '955,899,15,9', 'text': '12'}, {'boundingBox': '973,898,2,5', 'text': '，'}]}, {'boundingBox': '1261,898,98,13', 'words': [{'boundingBox': '1261,898,2,6', 'text': '，'}, {'boundingBox': '1267,899,15,9', 'text': '76'}, {'boundingBox': '1285,906,3,5', 'text': '，'}, {'boundingBox': '1290,899,16,9', 'text': '48'}, {'boundingBox': '1309,906,3,5', 'text': '，'}, {'boundingBox': '1315,899,15,9', 'text': '29'}, {'boundingBox': '1333,906,3,5', 'text': '，'}, {'boundingBox': '1339,898,20,10', 'text': '101'}]}, {'boundingBox': '1718,1025,15,10', 'words': [{'boundingBox': '1718,1025,15,10', 'text': 'UT'}]}], 'boundingBox': '19,48,1714,987'}, {'lines': [{'boundingBox': '234,48,126,10', 'words': [{'boundingBox': '234,48,51,10', 'text': 'Refactor'}, {'boundingBox': '299,49,22,9', 'text': 'Run'}, {'boundingBox': '335,49,7,9', 'text': 'T'}, {'boundingBox': '359,48,1,10', 'text': '丨'}]}, {'boundingBox': '343,51,24,7', 'words': [{'boundingBox': '343,51,6,7', 'text': '0'}, {'boundingBox': '351,51,6,7', 'text': '0'}, {'boundingBox': '362,51,5,7', 'text': 'S'}]}, {'boundingBox': '227,99,144,12', 'words': [{'boundingBox': '227,99,9,11', 'text': '，'}, {'boundingBox': '237,102,5,1', 'text': '一'}, {'boundingBox': '277,102,27,9', 'text': 'porn'}, {'boundingBox': '305,110,8,1', 'text': '一'}, {'boundingBox': '314,102,6,7', 'text': '0'}, {'boundingBox': '333,102,12,7', 'text': 'or'}, {'boundingBox': '346,99,6,10', 'text': '目'}, {'boundingBox': '366,102,5,9', 'text': 'y'}]}], 'boundingBox': '227,48,144,63'}, {'lines': [{'boundingBox': '380,48,87,10', 'words': [{'boundingBox': '380,49,16,9', 'text': 'VC'}, {'boundingBox': '398,49,6,9', 'text': 'S'}, {'boundingBox': '418,49,7,9', 'text': '7'}, {'boundingBox': '425,48,7,10', 'text': '山'}, {'boundingBox': '434,51,6,7', 'text': 'n'}, {'boundingBox': '442,48,6,10', 'text': '目'}, {'boundingBox': '450,51,17,7', 'text': 'OW'}]}, {'boundingBox': '379,96,93,16', 'words': [{'boundingBox': '379,101,7,7', 'text': '区'}, {'boundingBox': '405,96,33,16', 'text': '9BSSI'}, {'boundingBox': '444,102,6,9', 'text': 'p'}, {'boundingBox': '452,102,6,9', 'text': 'y'}, {'boundingBox': '465,101,7,7', 'text': '×'}]}], 'boundingBox': '379,48,93,64'}, {'lines': [{'boundingBox': '568,18,59,11', 'words': [{'boundingBox': '568,18,29,11', 'text': 'azu'}, {'boundingBox': '600,18,16,11', 'text': 're'}, {'boundingBox': '621,23,6,2', 'text': '一'}]}, {'boundingBox': '480,48,27,12', 'words': [{'boundingBox': '480,48,27,12', 'text': 'Help'}]}], 'boundingBox': '480,18,147,42'}, {'lines': [{'boundingBox': '639,13,712,21', 'words': [{'boundingBox': '639,20,9,3', 'text': '、'}, {'boundingBox': '649,13,46,21', 'text': '/Pyth'}, {'boundingBox': '698,18,21,11', 'text': 'on'}, {'boundingBox': '722,13,107,21', 'text': 'Projects/azu'}, {'boundingBox': '832,14,22,18', 'text': 'rel'}, {'boundingBox': '859,23,6,2', 'text': '一'}, {'boundingBox': '871,14,62,20', 'text': '.../porn'}, {'boundingBox': '947,13,93,21', 'text': 'oxford.py-'}, {'boundingBox': '1046,13,43,21', 'text': 'PyCh'}, {'boundingBox': '1092,18,33,11', 'text': 'arm'}, {'boundingBox': '1132,14,105,20', 'text': 'Community'}, {'boundingBox': '1242,13,61,16', 'text': 'Edition'}, {'boundingBox': '1310,15,9,14', 'text': '5'}, {'boundingBox': '1321,26,3,3', 'text': '．'}, {'boundingBox': '1326,15,9,14', 'text': '0'}, {'boundingBox': '1337,26,3,3', 'text': '．'}, {'boundingBox': '1341,15,10,14', 'text': '4'}]}], 'boundingBox': '639,13,712,21'}, {'lines': [{'boundingBox': '1607,70,142,19', 'words': [{'boundingBox': '1607,70,16,19', 'text': '匚'}, {'boundingBox': '1624,70,7,19', 'text': '：'}, {'boundingBox': '1632,70,20,19', 'text': '疃'}, {'boundingBox': '1708,70,16,19', 'text': '三'}, {'boundingBox': '1735,72,11,14', 'text': '>'}, {'boundingBox': '1744,83,5,5', 'text': '·'}]}], 'boundingBox': '1607,70,142,19'}, {'lines': [{'boundingBox': '1824,8,89,25', 'words': [{'boundingBox': '1824,17,16,9', 'text': '丷'}, {'boundingBox': '1858,13,16,16', 'text': '0'}, {'boundingBox': '1887,8,26,25', 'text': '．'}]}, {'boundingBox': '1839,71,76,16', 'words': [{'boundingBox': '1839,71,15,15', 'text': '，'}, {'boundingBox': '1864,72,14,14', 'text': '0'}, {'boundingBox': '1900,72,15,15', 'text': 'Q'}]}, {'boundingBox': '1837,898,68,13', 'words': [{'boundingBox': '1837,898,2,6', 'text': '，'}, {'boundingBox': '1843,898,29,10', 'text': 'Navi'}, {'boundingBox': '1875,899,30,12', 'text': 'gate'}]}], 'boundingBox': '1824,8,91,903'}, {'lines': [{'boundingBox': '322,138,22,10', 'words': [{'boundingBox': '322,138,22,10', 'text': 'def'}]}, {'boundingBox': '322,291,23,10', 'words': [{'boundingBox': '322,291,23,10', 'text': 'def'}]}, {'boundingBox': '322,478,22,10', 'words': [{'boundingBox': '322,478,22,10', 'text': 'def'}]}], 'boundingBox': '322,138,23,350'}, {'lines': [{'boundingBox': '604,171,91,14', 'words': [{'boundingBox': '604,172,2,4', 'text': "'"}, {'boundingBox': '644,180,2,2', 'text': '．'}, {'boundingBox': '651,171,44,14', 'text': 'read()'}]}], 'boundingBox': '604,171,91,14'}, {'lines': [{'boundingBox': '731,188,116,14', 'words': [{'boundingBox': '731,189,101,13', 'text': '"image/jpeg")'}, {'boundingBox': '843,188,4,14', 'text': '}'}]}, {'boundingBox': '737,223,135,13', 'words': [{'boundingBox': '737,224,8,9', 'text': '％'}, {'boundingBox': '754,226,52,10', 'text': 'params,'}, {'boundingBox': '817,223,55,13', 'text': 'Img_bin'}]}], 'boundingBox': '731,188,141,48'}, {'lines': [{'boundingBox': '354,138,148,13', 'words': [{'boundingBox': '354,138,141,13', 'text': 'update_photo(self)'}, {'boundingBox': '500,146,2,2', 'text': '，'}]}, {'boundingBox': '354,155,237,13', 'words': [{'boundingBox': '354,155,77,13', 'text': 'os.system('}, {'boundingBox': '450,158,3,7', 'text': '〔'}, {'boundingBox': '454,158,10,7', 'text': '了'}, {'boundingBox': '474,156,5,9', 'text': 't'}, {'boundingBox': '491,155,4,4', 'text': '"'}, {'boundingBox': '505,157,8,7', 'text': '+'}, {'boundingBox': '522,155,62,11', 'text': 'filename'}, {'boundingBox': '587,155,4,13', 'text': '）'}]}, {'boundingBox': '354,172,30,10', 'words': [{'boundingBox': '354,172,30,10', 'text': 'self'}]}, {'boundingBox': '393,172,63,13', 'words': [{'boundingBox': '393,172,63,13', 'text': '_lmg_bin'}]}, {'boundingBox': '482,172,107,13', 'words': [{'boundingBox': '482,172,107,13', 'text': 'open(filename,'}]}], 'boundingBox': '354,138,237,47'}, {'lines': [{'boundingBox': '40,160,107,12', 'words': [{'boundingBox': '40,160,83,10', 'text': 'loafter-sex-l'}, {'boundingBox': '126,163,21,9', 'text': '.Jpg'}]}, {'boundingBox': '39,180,70,12', 'words': [{'boundingBox': '39,180,70,12', 'text': 'heheda.jpg'}]}, {'boundingBox': '39,200,91,12', 'words': [{'boundingBox': '39,200,67,10', 'text': 'home-train'}, {'boundingBox': '109,203,5,9', 'text': '刂'}, {'boundingBox': '116,203,6,9', 'text': 'p'}, {'boundingBox': '124,203,6,9', 'text': 'g'}]}, {'boundingBox': '39,223,67,9', 'words': [{'boundingBox': '39,223,1,7', 'text': '丨'}, {'boundingBox': '42,223,9,7', 'text': 'm'}, {'boundingBox': '53,223,6,7', 'text': '彐'}, {'boundingBox': '61,223,6,9', 'text': 'g'}, {'boundingBox': '69,223,6,7', 'text': 'e'}, {'boundingBox': '77,223,5,7', 'text': 'S'}, {'boundingBox': '85,223,5,9', 'text': '刂'}, {'boundingBox': '92,223,6,9', 'text': 'P'}, {'boundingBox': '100,223,6,9', 'text': 'g'}]}, {'boundingBox': '39,240,61,12', 'words': [{'boundingBox': '39,240,37,10', 'text': 'naked'}, {'boundingBox': '79,243,5,9', 'text': '刂'}, {'boundingBox': '86,243,6,9', 'text': 'p'}, {'boundingBox': '94,243,6,9', 'text': 'g'}]}, {'boundingBox': '39,260,177,12', 'words': [{'boundingBox': '39,260,177,12', 'text': '0-COlJPLE-SEX-facebOOk.jpg'}]}, {'boundingBox': '38,280,206,12', 'words': [{'boundingBox': '38,280,206,12', 'text': 'tgv_high-spped_train_france.jpg'}]}, {'boundingBox': '39,300,150,12', 'words': [{'boundingBox': '39,300,126,12', 'text': 'yellow-wallpaper-Il'}, {'boundingBox': '168,303,5,9', 'text': '刂'}, {'boundingBox': '175,303,6,9', 'text': 'p'}, {'boundingBox': '183,303,6,9', 'text': 'g'}]}, {'boundingBox': '20,340,95,12', 'words': [{'boundingBox': '20,340,95,12', 'text': '.screenshot.jpg'}]}, {'boundingBox': '19,360,112,10', 'words': [{'boundingBox': '19,360,112,10', 'text': 'anti-LOL-to-fronto'}]}, {'boundingBox': '19,380,95,12', 'words': [{'boundingBox': '19,382,27,10', 'text': '00m'}, {'boundingBox': '47,391,9,1', 'text': '一'}, {'boundingBox': '56,383,6,8', 'text': '0'}, {'boundingBox': '63,380,11,12', 'text': '对'}, {'boundingBox': '75,383,6,7', 'text': '。'}, {'boundingBox': '82,382,5,8', 'text': 'r'}, {'boundingBox': '88,380,11,12', 'text': '山'}, {'boundingBox': '100,382,14,10', 'text': 'py'}]}, {'boundingBox': '19,403,64,9', 'words': [{'boundingBox': '19,403,5,7', 'text': 'S'}, {'boundingBox': '26,403,17,7', 'text': 'cre'}, {'boundingBox': '45,403,6,7', 'text': 'e'}, {'boundingBox': '53,403,6,7', 'text': 'n'}, {'boundingBox': '62,403,5,9', 'text': '刂'}, {'boundingBox': '69,403,6,9', 'text': 'p'}, {'boundingBox': '77,403,6,9', 'text': '口'}]}, {'boundingBox': '6,420,101,10', 'words': [{'boundingBox': '6,420,43,10', 'text': 'xternal'}, {'boundingBox': '55,420,52,10', 'text': 'Libraries'}]}, {'boundingBox': '6,807,114,13', 'words': [{'boundingBox': '6,808,6,8', 'text': 'R'}, {'boundingBox': '14,810,5,6', 'text': 'u'}, {'boundingBox': '21,810,5,6', 'text': 'n'}, {'boundingBox': '43,815,5,5', 'text': '·'}, {'boundingBox': '52,807,68,11', 'text': 'porn_oxford'}]}], 'boundingBox': '6,160,238,660'}, {'lines': [{'boundingBox': '353,189,71,10', 'words': [{'boundingBox': '353,190,8,9', 'text': '，'}, {'boundingBox': '370,189,54,10', 'text': 'headers'}]}, {'boundingBox': '450,189,253,13', 'words': [{'boundingBox': '450,189,30,10', 'text': 'self'}, {'boundingBox': '484,189,219,13', 'text': '.headers_gen(("Content-Type"'}]}, {'boundingBox': '442,206,133,13', 'words': [{'boundingBox': '442,206,30,10', 'text': 'self'}, {'boundingBox': '476,214,2,2', 'text': '．'}, {'boundingBox': '571,206,4,13', 'text': '}'}]}, {'boundingBox': '370,209,46,10', 'words': [{'boundingBox': '370,209,46,10', 'text': 'params'}]}, {'boundingBox': '370,223,197,13', 'words': [{'boundingBox': '370,223,30,10', 'text': 'self'}, {'boundingBox': '404,231,2,2', 'text': '．'}, {'boundingBox': '408,226,16,9', 'text': '_C'}, {'boundingBox': '426,226,6,7', 'text': '0'}, {'boundingBox': '434,226,6,7', 'text': 'n'}, {'boundingBox': '442,226,6,7', 'text': 'n'}, {'boundingBox': '452,231,2,2', 'text': '．'}, {'boundingBox': '459,223,108,13', 'text': 'request("POST"'}]}, {'boundingBox': '587,223,137,13', 'words': [{'boundingBox': '587,223,4,4', 'text': '"'}, {'boundingBox': '594,223,126,13', 'text': '/Image/Cache/&%s'}, {'boundingBox': '723,223,1,4', 'text': "'"}]}, {'boundingBox': '353,240,47,10', 'words': [{'boundingBox': '353,241,7,9', 'text': '的'}, {'boundingBox': '370,240,30,10', 'text': 'data'}]}, {'boundingBox': '426,240,245,13', 'words': [{'boundingBox': '426,240,30,10', 'text': 'self'}, {'boundingBox': '460,248,2,2', 'text': '．'}, {'boundingBox': '464,243,16,9', 'text': '_c'}, {'boundingBox': '482,243,6,7', 'text': '0'}, {'boundingBox': '490,243,6,7', 'text': 'n'}, {'boundingBox': '498,243,6,7', 'text': 'n'}, {'boundingBox': '508,248,2,2', 'text': '．'}, {'boundingBox': '514,240,101,13', 'text': 'getresponse()'}, {'boundingBox': '620,248,2,2', 'text': '．'}, {'boundingBox': '627,240,29,11', 'text': 'read'}, {'boundingBox': '659,240,4,13', 'text': '{'}, {'boundingBox': '668,240,3,13', 'text': '，'}]}, {'boundingBox': '370,257,85,13', 'words': [{'boundingBox': '370,257,85,13', 'text': 'print(data)'}]}, {'boundingBox': '370,274,102,10', 'words': [{'boundingBox': '370,274,36,10', 'text': 'self.'}, {'boundingBox': '418,274,54,10', 'text': 'cacheID'}]}, {'boundingBox': '498,274,117,13', 'words': [{'boundingBox': '498,274,117,13', 'text': 'dataC"CacheId"J'}]}, {'boundingBox': '418,291,31,10', 'words': [{'boundingBox': '418,291,31,10', 'text': 'hOtO'}]}, {'boundingBox': '458,291,30,10', 'words': [{'boundingBox': '458,291,30,10', 'text': 'self'}]}, {'boundingBox': '450,325,133,13', 'words': [{'boundingBox': '450,325,30,10', 'text': 'self'}, {'boundingBox': '484,333,2,2', 'text': '．'}, {'boundingBox': '490,325,93,13', 'text': 'headers_gen('}]}, {'boundingBox': '353,325,71,10', 'words': [{'boundingBox': '353,326,8,9', 'text': '，'}, {'boundingBox': '370,325,54,10', 'text': 'headers'}]}], 'boundingBox': '353,189,371,149'}, {'lines': [{'boundingBox': '890,223,61,13', 'words': [{'boundingBox': '890,223,61,13', 'text': 'headers)'}]}], 'boundingBox': '890,223,61,13'}, {'lines': [{'boundingBox': '906,359,61,13', 'words': [{'boundingBox': '906,359,61,13', 'text': 'headers)'}]}], 'boundingBox': '906,359,61,13'}, {'lines': [{'boundingBox': '442,342,301,14', 'words': [{'boundingBox': '442,342,30,10', 'text': 'self'}, {'boundingBox': '476,350,2,2', 'text': '．'}, {'boundingBox': '482,342,182,14', 'text': 'params_gen(CacheIDzse1f'}, {'boundingBox': '668,342,75,13', 'text': '._cacheID)'}]}, {'boundingBox': '370,345,46,10', 'words': [{'boundingBox': '370,345,46,10', 'text': 'params'}]}, {'boundingBox': '370,359,213,13', 'words': [{'boundingBox': '370,359,30,10', 'text': 'self'}, {'boundingBox': '404,362,44,9', 'text': '._conn'}, {'boundingBox': '452,367,2,2', 'text': '．'}, {'boundingBox': '459,359,124,13', 'text': 'request("DELETE"'}]}, {'boundingBox': '603,359,219,13', 'words': [{'boundingBox': '603,359,140,13', 'text': 'V\'/Image/Cache/&%s"'}, {'boundingBox': '753,360,8,9', 'text': '％'}, {'boundingBox': '770,362,52,10', 'text': 'params,'}]}], 'boundingBox': '370,342,452,30'}, {'lines': [{'boundingBox': '833,359,61,13', 'words': [{'boundingBox': '833,359,55,13', 'text': 'Img_bin'}, {'boundingBox': '891,367,3,4', 'text': '，'}]}], 'boundingBox': '833,359,61,13'}, {'lines': [{'boundingBox': '498,391,69,17', 'words': [{'boundingBox': '498,393,22,10', 'text': 'dic'}, {'boundingBox': '521,405,3,3', 'text': '、'}, {'boundingBox': '524,405,5,3', 'text': '、'}, {'boundingBox': '530,397,6,4', 'text': '：'}, {'boundingBox': '545,391,16,17', 'text': '0'}, {'boundingBox': '563,393,4,13', 'text': '}'}]}, {'boundingBox': '322,393,163,13', 'words': [{'boundingBox': '322,393,23,10', 'text': 'def'}, {'boundingBox': '354,393,131,13', 'text': 'headers_gen(self,'}]}, {'boundingBox': '354,410,54,10', 'words': [{'boundingBox': '354,410,54,10', 'text': 'headers'}]}, {'boundingBox': '434,410,149,13', 'words': [{'boundingBox': '434,410,30,10', 'text': 'self'}, {'boundingBox': '468,410,60,10', 'text': '.headers'}, {'boundingBox': '532,418,2,2', 'text': '．'}, {'boundingBox': '538,410,45,13', 'text': 'copy()'}]}, {'boundingBox': '354,427,149,13', 'words': [{'boundingBox': '354,427,149,13', 'text': 'headers.update(dic)'}]}, {'boundingBox': '354,444,110,10', 'words': [{'boundingBox': '354,447,6,7', 'text': 'r'}, {'boundingBox': '378,447,6,7', 'text': 'u'}, {'boundingBox': '386,447,6,7', 'text': 'r'}, {'boundingBox': '394,447,6,7', 'text': 'n'}, {'boundingBox': '410,444,54,10', 'text': 'headers'}]}, {'boundingBox': '499,477,60,15', 'words': [{'boundingBox': '499,477,60,15', 'text': '*kwargs)'}]}, {'boundingBox': '426,495,109,13', 'words': [{'boundingBox': '426,495,109,13', 'text': 'dict("kwargs)'}]}, {'boundingBox': '426,512,237,13', 'words': [{'boundingBox': '426,515,6,7', 'text': 'u'}, {'boundingBox': '435,512,37,10', 'text': 'rllib'}, {'boundingBox': '476,520,2,2', 'text': '．'}, {'boundingBox': '482,515,38,10', 'text': 'parse'}, {'boundingBox': '524,520,2,2', 'text': '．'}, {'boundingBox': '530,512,133,13', 'text': 'urlencode(params)'}]}, {'boundingBox': '354,532,47,7', 'words': [{'boundingBox': '354,532,6,7', 'text': 'r'}, {'boundingBox': '378,532,6,7', 'text': 'u'}, {'boundingBox': '386,532,6,7', 'text': 'r'}, {'boundingBox': '394,532,7,7', 'text': 'n'}]}, {'boundingBox': '322,563,156,13', 'words': [{'boundingBox': '322,563,23,10', 'text': 'def'}, {'boundingBox': '353,564,71,12', 'text': 'porn_text'}, {'boundingBox': '427,563,4,13', 'text': '（'}, {'boundingBox': '434,563,30,10', 'text': 'self'}, {'boundingBox': '467,563,4,13', 'text': '）'}, {'boundingBox': '477,571,1,2', 'text': 'I'}]}, {'boundingBox': '354,580,149,13', 'words': [{'boundingBox': '354,580,30,10', 'text': 'self'}, {'boundingBox': '388,588,2,2', 'text': '．'}, {'boundingBox': '394,580,109,13', 'text': 'update_photo()'}]}, {'boundingBox': '426,597,269,13', 'words': [{'boundingBox': '426,597,30,10', 'text': 'self'}, {'boundingBox': '460,605,2,2', 'text': '．'}, {'boundingBox': '466,597,85,13', 'text': 'params_gen('}, {'boundingBox': '627,597,4,4', 'text': '"'}, {'boundingBox': '634,600,6,7', 'text': '二'}, {'boundingBox': '642,597,6,10', 'text': '卜'}, {'boundingBox': '651,603,4,1', 'text': '一'}, {'boundingBox': '658,598,6,9', 'text': 'H'}, {'boundingBox': '666,600,6,7', 'text': 'a'}, {'boundingBox': '674,600,6,7', 'text': 'n'}, {'boundingBox': '682,600,6,7', 'text': 's'}, {'boundingBox': '691,597,4,4', 'text': '"'}]}, {'boundingBox': '354,600,46,10', 'words': [{'boundingBox': '354,600,46,10', 'text': 'params'}]}, {'boundingBox': '354,614,54,10', 'words': [{'boundingBox': '354,614,54,10', 'text': 'headers'}]}, {'boundingBox': '434,614,205,13', 'words': [{'boundingBox': '434,614,30,10', 'text': 'self'}, {'boundingBox': '468,614,171,13', 'text': '.headers_gen(("(;ontent'}]}, {'boundingBox': '354,631,197,14', 'words': [{'boundingBox': '354,631,110,13', 'text': 'print(len(self'}, {'boundingBox': '468,631,68,13', 'text': '._img_bin'}, {'boundingBox': '539,631,4,13', 'text': '）'}, {'boundingBox': '546,631,5,14', 'text': '）'}]}], 'boundingBox': '322,391,373,254'}, {'lines': [{'boundingBox': '961,665,62,13', 'words': [{'boundingBox': '961,665,62,13', 'text': 'headers)'}]}, {'boundingBox': '997,898,37,10', 'words': [{'boundingBox': '997,898,2,6', 'text': '，'}, {'boundingBox': '1003,899,31,9', 'text': 'text'}]}], 'boundingBox': '961,665,73,243'}, {'lines': [{'boundingBox': '714,596,189,14', 'words': [{'boundingBox': '714,596,189,14', 'text': 'detectorlentatIanzFalse)'}]}], 'boundingBox': '714,596,189,14'}, {'lines': [{'boundingBox': '603,663,347,17', 'words': [{'boundingBox': '603,665,4,4', 'text': '"'}, {'boundingBox': '610,666,5,9', 'text': '丿'}, {'boundingBox': '618,665,30,11', 'text': 'visi'}, {'boundingBox': '650,668,6,7', 'text': '卩'}, {'boundingBox': '658,668,6,8', 'text': '卩'}, {'boundingBox': '666,666,5,9', 'text': '丿'}, {'boundingBox': '674,666,14,10', 'text': 'vA'}, {'boundingBox': '702,668,2,7', 'text': '，'}, {'boundingBox': '706,668,10,7', 'text': '凵'}, {'boundingBox': '717,666,11,9', 'text': '霪'}, {'boundingBox': '738,668,6,7', 'text': '卜'}, {'boundingBox': '747,665,4,4', 'text': '"'}, {'boundingBox': '761,666,8,10', 'text': '％'}, {'boundingBox': '778,663,46,17', 'text': 'pyrams'}, {'boundingBox': '827,673,3,4', 'text': '，'}, {'boundingBox': '842,665,30,11', 'text': 'self'}, {'boundingBox': '876,665,68,13', 'text': '._img_bin'}, {'boundingBox': '947,673,3,4', 'text': '，'}]}, {'boundingBox': '386,665,197,13', 'words': [{'boundingBox': '386,665,30,11', 'text': 'self'}, {'boundingBox': '420,667,44,10', 'text': '._conn'}, {'boundingBox': '468,673,2,2', 'text': '．'}, {'boundingBox': '475,665,60,13', 'text': 'request('}, {'boundingBox': '539,665,44,10', 'text': '\'\'POST"'}]}, {'boundingBox': '474,682,189,13', 'words': [{'boundingBox': '474,682,30,10', 'text': 'self'}, {'boundingBox': '508,690,2,2', 'text': '．'}, {'boundingBox': '512,685,16,9', 'text': '_c'}, {'boundingBox': '530,685,6,7', 'text': '0'}, {'boundingBox': '538,685,6,7', 'text': 'n'}, {'boundingBox': '546,685,6,7', 'text': 'n'}, {'boundingBox': '556,690,2,2', 'text': '．'}, {'boundingBox': '562,682,101,13', 'text': 'getresponse()'}]}, {'boundingBox': '387,685,61,10', 'words': [{'boundingBox': '387,685,61,10', 'text': 'response'}]}, {'boundingBox': '354,716,565,13', 'words': [{'boundingBox': '354,717,46,12', 'text': 'except'}, {'boundingBox': '411,716,59,13', 'text': '(socket.'}, {'boundingBox': '474,716,60,12', 'text': 'timeout,'}, {'boundingBox': '546,716,124,13', 'text': 'socket.galerror,'}, {'boundingBox': '682,716,237,13', 'text': 'http.c1ient.CannotSendRequest)'}]}, {'boundingBox': '386,733,61,13', 'words': [{'boundingBox': '386,736,6,10', 'text': '卩'}, {'boundingBox': '395,733,13,10', 'text': 'ri'}, {'boundingBox': '410,736,6,7', 'text': 'n'}, {'boundingBox': '418,734,6,9', 'text': 't'}, {'boundingBox': '427,733,4,13', 'text': '（'}, {'boundingBox': '434,736,6,7', 'text': 'e'}, {'boundingBox': '443,733,4,13', 'text': '}'}]}, {'boundingBox': '386,750,30,10', 'words': [{'boundingBox': '386,750,30,10', 'text': 'self'}]}, {'boundingBox': '386,767,30,10', 'words': [{'boundingBox': '386,767,30,10', 'text': 'self'}]}, {'boundingBox': '386,785,70,9', 'words': [{'boundingBox': '386,787,6,7', 'text': 'r'}, {'boundingBox': '394,787,6,7', 'text': 'e'}, {'boundingBox': '418,787,6,7', 'text': 'r'}, {'boundingBox': '426,787,2,7', 'text': '丨'}, {'boundingBox': '429,787,3,7', 'text': '1'}, {'boundingBox': '443,790,4,1', 'text': '一'}, {'boundingBox': '450,785,6,9', 'text': '1'}]}], 'boundingBox': '354,663,596,131'}, {'lines': [{'boundingBox': '669,898,50,6', 'words': [{'boundingBox': '669,898,2,6', 'text': '，'}, {'boundingBox': '717,898,2,5', 'text': '1'}]}], 'boundingBox': '669,898,50,6'}, {'lines': [{'boundingBox': '725,898,130,13', 'words': [{'boundingBox': '725,906,3,2', 'text': '．'}, {'boundingBox': '741,898,4,12', 'text': '['}, {'boundingBox': '763,898,45,10', 'text': 'boundi'}, {'boundingBox': '811,899,39,12', 'text': 'ngBox'}, {'boundingBox': '853,898,2,5', 'text': "'"}]}], 'boundingBox': '725,898,130,13'}, {'lines': [{'boundingBox': '1061,898,37,10', 'words': [{'boundingBox': '1061,898,2,6', 'text': '，'}, {'boundingBox': '1067,898,21,10', 'text': 'Edi'}, {'boundingBox': '1091,899,7,9', 'text': '七'}]}], 'boundingBox': '1061,898,37,10'}, {'lines': [{'boundingBox': '1117,898,122,13', 'words': [{'boundingBox': '1117,906,3,5', 'text': '，'}, {'boundingBox': '1147,898,45,10', 'text': 'boundi'}, {'boundingBox': '1195,899,39,12', 'text': 'ngBox'}, {'boundingBox': '1237,898,2,5', 'text': '1'}]}], 'boundingBox': '1117,898,122,13'}, {'lines': [{'boundingBox': '1381,898,37,10', 'words': [{'boundingBox': '1381,898,2,6', 'text': '，'}, {'boundingBox': '1387,899,31,9', 'text': 'text'}]}], 'boundingBox': '1381,898,37,10'}, {'lines': [{'boundingBox': '1445,898,59,13', 'words': [{'boundingBox': '1445,898,2,6', 'text': '，'}, {'boundingBox': '1451,898,13,10', 'text': 'Vi'}, {'boundingBox': '1467,900,15,8', 'text': 'ew'}, {'boundingBox': '1485,898,2,5', 'text': '1'}, {'boundingBox': '1491,898,6,12', 'text': '}'}, {'boundingBox': '1501,906,3,5', 'text': '，'}]}], 'boundingBox': '1445,898,59,13'}, {'lines': [{'boundingBox': '1531,898,92,13', 'words': [{'boundingBox': '1531,898,45,10', 'text': 'boundi'}, {'boundingBox': '1579,899,39,12', 'text': 'ngBox'}, {'boundingBox': '1621,898,2,5', 'text': '1'}]}], 'boundingBox': '1531,898,92,13'}, {'lines': [{'boundingBox': '1645,898,106,13', 'words': [{'boundingBox': '1645,898,2,6', 'text': '，'}, {'boundingBox': '1651,899,23,9', 'text': '119'}, {'boundingBox': '1677,906,3,5', 'text': '，'}, {'boundingBox': '1682,899,16,9', 'text': '48'}, {'boundingBox': '1701,906,3,5', 'text': '，'}, {'boundingBox': '1707,899,15,9', 'text': '55'}, {'boundingBox': '1725,905,3,6', 'text': '，'}, {'boundingBox': '1731,898,20,10', 'text': '121'}]}], 'boundingBox': '1645,898,106,13'}, {'lines': [{'boundingBox': '1773,898,37,10', 'words': [{'boundingBox': '1773,898,2,6', 'text': '，'}, {'boundingBox': '1779,899,31,9', 'text': 'text'}]}], 'boundingBox': '1773,898,37,10'}, {'lines': [{'boundingBox': '76,826,518,13', 'words': [{'boundingBox': '76,826,141,13', 'text': '/usr/bnn/python3.5'}, {'boundingBox': '228,828,4,10', 'text': '/'}, {'boundingBox': '235,826,37,12', 'text': 'home/'}, {'boundingBox': '275,826,13,10', 'text': 'mi'}, {'boundingBox': '291,826,21,12', 'text': 'kel'}, {'boundingBox': '315,826,77,13', 'text': 'PythonPr0J'}, {'boundingBox': '395,827,30,9', 'text': 'ects'}, {'boundingBox': '428,828,4,10', 'text': '/'}, {'boundingBox': '435,829,22,7', 'text': 'azu'}, {'boundingBox': '460,828,20,10', 'text': 're/'}, {'boundingBox': '483,826,86,13', 'text': 'porn_oxford'}, {'boundingBox': '573,834,2,2', 'text': '．'}, {'boundingBox': '579,829,15,10', 'text': 'py'}]}, {'boundingBox': '75,845,159,10', 'words': [{'boundingBox': '75,845,7,9', 'text': 'El'}, {'boundingBox': '85,852,2,2', 'text': '．'}, {'boundingBox': '91,845,143,10', 'text': 'ee5e43745e4e893555'}]}], 'boundingBox': '75,826,519,29'}, {'lines': [{'boundingBox': '317,898,66,12', 'words': [{'boundingBox': '317,898,4,12', 'text': '['}, {'boundingBox': '324,898,11,12', 'text': "C'"}, {'boundingBox': '355,901,23,8', 'text': 'nes'}, {'boundingBox': '381,898,2,5', 'text': '1'}]}], 'boundingBox': '317,898,66,12'}, {'lines': [{'boundingBox': '405,898,109,13', 'words': [{'boundingBox': '405,898,4,12', 'text': '['}, {'boundingBox': '427,898,45,10', 'text': 'boundi'}, {'boundingBox': '475,899,39,12', 'text': 'ngBox'}]}], 'boundingBox': '405,898,109,13'}, {'lines': [{'boundingBox': '74,862,87,10', 'words': [{'boundingBox': '74,863,24,9', 'text': 'ARE'}, {'boundingBox': '107,863,4,9', 'text': '丶'}, {'boundingBox': '111,863,3,5', 'text': "'"}, {'boundingBox': '115,863,15,9', 'text': 'OU'}, {'boundingBox': '139,862,22,10', 'text': 'OK?'}]}, {'boundingBox': '75,881,46,9', 'words': [{'boundingBox': '75,881,46,9', 'text': '157e23'}]}, {'boundingBox': '76,898,91,13', 'words': [{'boundingBox': '76,898,11,12', 'text': "-l'"}, {'boundingBox': '91,898,71,13', 'text': 'textAngIe'}, {'boundingBox': '165,898,2,5', 'text': '1'}]}, {'boundingBox': '75,917,15,10', 'words': [{'boundingBox': '75,917,15,10', 'text': 'OK'}]}, {'boundingBox': '75,935,143,9', 'words': [{'boundingBox': '75,935,7,9', 'text': '1'}, {'boundingBox': '85,942,2,2', 'text': '．'}, {'boundingBox': '91,935,127,9', 'text': '548949ee32196e45'}]}, {'boundingBox': '54,1045,112,29', 'words': [{'boundingBox': '54,1048,28,25', 'text': '，'}, {'boundingBox': '138,1045,28,29', 'text': '0'}]}], 'boundingBox': '54,862,164,212'}, {'lines': [{'boundingBox': '293,898,2,5', 'words': [{'boundingBox': '293,898,2,5', 'text': '1'}]}], 'boundingBox': '293,898,2,5'}, {'lines': [{'boundingBox': '1771,1026,69,9', 'words': [{'boundingBox': '1771,1026,7,9', 'text': 'G'}, {'boundingBox': '1780,1026,7,9', 'text': 'It'}, {'boundingBox': '1789,1028,1,7', 'text': '：'}, {'boundingBox': '1797,1028,9,7', 'text': 'm'}, {'boundingBox': '1808,1028,6,7', 'text': '彐'}, {'boundingBox': '1816,1026,18,9', 'text': 'Ste'}, {'boundingBox': '1836,1028,4,7', 'text': 'r'}]}, {'boundingBox': '1776,1052,106,18', 'words': [{'boundingBox': '1776,1057,12,7', 'text': '^'}, {'boundingBox': '1800,1052,11,18', 'text': '8'}, {'boundingBox': '1814,1057,3,13', 'text': '：'}, {'boundingBox': '1820,1052,62,18', 'text': '09AM'}]}], 'boundingBox': '1771,1026,111,44'}, {'lines': [{'boundingBox': '218,1052,298,20', 'words': [{'boundingBox': '218,1052,134,18', 'text': 'MicrosoftProject'}, {'boundingBox': '357,1053,11,13', 'text': '0'}, {'boundingBox': '369,1052,14,14', 'text': '对'}, {'boundingBox': '384,1052,24,14', 'text': 'ord'}, {'boundingBox': '414,1053,25,13', 'text': 'API'}, {'boundingBox': '445,1052,31,14', 'text': 'Refe'}, {'boundingBox': '488,1055,10,17', 'text': '卩'}, {'boundingBox': '514,1057,2,4', 'text': '，'}]}], 'boundingBox': '218,1052,298,20'}, {'lines': [{'boundingBox': '528,1056,42,10', 'words': [{'boundingBox': '528,1056,42,10', 'text': 'azure'}]}], 'boundingBox': '528,1056,42,10'}, {'lines': [{'boundingBox': '574,1051,514,19', 'words': [{'boundingBox': '574,1060,6,2', 'text': '一'}, {'boundingBox': '585,1052,14,17', 'text': '卜'}, {'boundingBox': '599,1051,182,19', 'text': '/PythonPr0jects/azureI'}, {'boundingBox': '788,1060,4,3', 'text': '一'}, {'boundingBox': '837,1051,17,17', 'text': '连'}, {'boundingBox': '855,1051,15,17', 'text': '接'}, {'boundingBox': '872,1051,15,17', 'text': '编'}, {'boundingBox': '889,1051,15,17', 'text': '辑'}, {'boundingBox': '905,1052,17,16', 'text': '器'}, {'boundingBox': '927,1061,14,1', 'text': '一'}, {'boundingBox': '946,1052,38,14', 'text': 'Shad'}, {'boundingBox': '987,1051,101,18', 'text': 'owsocks-Qt5'}]}], 'boundingBox': '574,1051,514,19'}], 'language': 'zh-Hans', 'orientation': 'NotDetected'}

    '''
